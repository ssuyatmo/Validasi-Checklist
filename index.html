<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QA Inspection App</title>
<style>
body {
  font-family: "Segoe UI", sans-serif;
  background: linear-gradient(to bottom, #e6f5e6, #f9f9f9);
  margin: 0; padding: 0;
}
header {
  background: linear-gradient(90deg, #d4af37, #e6c76f);
  color: #003300;
  text-align: center;
  padding: 10px;
  font-weight: bold;
  border-bottom: 2px solid #caa74a;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
}
header img {
  width: 30px; height: 30px;
}
.container {
  max-width: 600px;
  margin: 8px auto;
  background: white;
  padding: 10px;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
.section {
  margin-bottom: 8px;
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 8px;
  background: #fcfcfc;
}
.section h3 {
  font-size: 15px;
  background: #e0f4e0;
  padding: 4px;
  border-radius: 5px;
  color: #003300;
}
.item-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 3px 0;
}
.item-row label {
  flex: 1;
  font-size: 13px;
}
.item-buttons button {
  font-size: 13px;
  padding: 2px 8px;
  margin-left: 3px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: 0.2s;
}
.good { background: #d4edda; color: #155724; }
.bad { background: #f8d7da; color: #721c24; }
.temuan {
  width: 100%;
  margin-top: 3px;
  font-size: 12px;
  padding: 4px;
  border: 1px solid #ccc;
  border-radius: 6px;
}
textarea {
  width: 100%;
  border-radius: 6px;
  border: 1px solid #ccc;
  padding: 5px;
  font-size: 12px;
  resize: vertical;
}
button.action {
  font-size: 13px;
  padding: 6px 12px;
  margin: 4px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  color: white;
}
#preview { background: #17a2b8; }
#copy { background: #28a745; }
#send { background: #007bff; }
button.action:hover { opacity: 0.85; }
#previewBox {
  background: #fff;
  padding: 8px;
  border-radius: 8px;
  margin-top: 10px;
  font-size: 13px;
  white-space: pre-wrap;
  box-shadow: inset 0 0 5px rgba(0,0,0,0.1);
}
</style>
</head>
<body>

<header>
  <img src="https://cdn-icons-png.flaticon.com/512/3177/3177440.png" alt="HD785-7">
  <span>QA Inspection (HD785-7)</span>
</header>

<div class="container">
  <div class="section">
    <label>Inspection Type:</label>
    <select id="inspectionType">
      <option value="QA-1">QA-1 Pre Inspection</option>
      <option value="QA-7">QA-7 Final Inspection</option>
    </select>
    <label>Tanggal:</label><input id="tgl" type="date" style="width:100%">
    <label>Mekanik:</label><input id="mekanik" type="text" style="width:100%">
    <label>CN Unit:</label><input id="cn" type="text" style="width:100%">
    <label>HM:</label><input id="hm" type="text" style="width:100%">
  </div>

  <div id="inspectionSections"></div>

  <div class="section">
    <h3>‚ö†Ô∏è Deviation</h3>
    <textarea id="manualDeviation" rows="3" placeholder="Tambahkan deviasi manual jika ada..."></textarea>
  </div>

  <div style="text-align:center;">
    <button class="action" id="preview">üßæ Preview</button>
    <button class="action" id="copy">üìã Copy</button>
    <button class="action" id="send">üì§ Send WhatsApp</button>
  </div>

  <div id="previewBox" placeholder="Preview akan muncul di sini..."></div>
</div>

<script>
const sections = {
  "Oil Level": ["Engine oil level", "Transmission oil level", "Hydraulic oil level"],
  "Engine Area": ["Belt tension", "Engine oil leakage", "Common Rail Connector", "Injector Tube"],
  "Cabin Area": ["FM Radio", "Fatigue Warning", "Power Window"],
  "Frame Area": ["Operator seat", "Hand Rail"],
  "Pressure Suspension (Panel)": ["FL", "FR", "RL", "RR"],
  "Tyre Condition": ["Tyre"]
};

const validationQA1 = [
  "Job Card & Cover Checklist", "Form Observasi Redo PS", "Form QA 1 & QA 7",
  "Form PPM", "Form Check List A", "Form Check List B", "Form Check List C",
  "Form Backlog", "Form FUI", "Form Repair Order", "Form Combine Maintenance", "Form Service Activity Report"
];

function createInspectionSections() {
  const container = document.getElementById("inspectionSections");
  container.innerHTML = "";

  for (let [title, items] of Object.entries(sections)) {
    const sec = document.createElement("div");
    sec.className = "section";
    sec.innerHTML = `<h3>${title}</h3>`;
    items.forEach(it => {
      const row = document.createElement("div");
      row.className = "item-row";
      row.innerHTML = `
        <label>${it}</label>
        <div class="item-buttons">
          <button onclick="toggleBtn(this,'good')">‚úÖ</button>
          <button onclick="toggleBtn(this,'bad')">‚ùå</button>
        </div>`;
      sec.appendChild(row);
      const t = document.createElement("input");
      t.placeholder = "Tambahkan temuan jika ada...";
      t.className = "temuan";
      sec.appendChild(t);
    });
    container.appendChild(sec);
  }

  // Validation section
  const vsec = document.createElement("div");
  vsec.className = "section";
  vsec.innerHTML = `<h3 id="validTitle">üìù Validasi & Kelengkapan Checklist Service</h3>`;
  validationQA1.forEach(v => {
    const row = document.createElement("div");
    row.className = "item-row";
    row.innerHTML = `
      <label>${v}</label>
      <div class="item-buttons">
        <button onclick="toggleBtn(this,'good')">‚úÖ</button>
        <button onclick="toggleBtn(this,'bad')">‚ùå</button>
      </div>`;
    vsec.appendChild(row);
  });
  container.appendChild(vsec);
}
createInspectionSections();

function toggleBtn(btn, type) {
  const siblings = btn.parentElement.querySelectorAll("button");
  siblings.forEach(b => b.classList.remove("good","bad"));
  if (type === "good") btn.classList.add("good");
  else btn.classList.add("bad");
}

function generateFormat() {
  const type = document.getElementById("inspectionType").value;
  document.getElementById("validTitle").textContent =
    type === "QA-1" ? "üìù Validasi & Kelengkapan Checklist Service" : "üìù Kelengkapan Pengisian Checklist Service";

  let text = `üìÖ Tgl : ${document.getElementById("tgl").value}
üë∑ Mekanik : ${document.getElementById("mekanik").value}
üöó CN : ${document.getElementById("cn").value}
‚åõ HM : ${document.getElementById("hm").value}

---

`;

  const deviations = [];

  for (let [title, items] of Object.entries(sections)) {
    text += `üß© ${title}\n`;
    const section = Array.from(document.querySelectorAll(".section")).find(s => s.querySelector("h3").textContent === title);
    const rows = section.querySelectorAll(".item-row");
    const inputs = section.querySelectorAll(".temuan");
    rows.forEach((r,i)=>{
      const label = r.querySelector("label").textContent;
      const good = r.querySelector("button.good");
      const bad = r.querySelector("button.bad");
      const value = good ? "GOOD" : bad ? "BAD" : "";
      text += `${label} : ${value ? (value==="GOOD"?"‚úÖ GOOD":"‚ùå BAD"):""}\n`;
      const temuan = inputs[i].value.trim();
      if (temuan) deviations.push(temuan);
    });
    text += "\n---\n\n";
  }

  // Validasi Section
  text += document.getElementById("validTitle").textContent + "\n";
  const valSec = Array.from(document.querySelectorAll(".section")).find(s => s.querySelector("h3").id === "validTitle");
  const valRows = valSec.querySelectorAll(".item-row");
  valRows.forEach(r=>{
    const label = r.querySelector("label").textContent;
    const good = r.querySelector("button.good");
    const bad = r.querySelector("button.bad");
    const value = good?"‚úÖ":bad?"‚ùå":"";
    text += `${label} ${value}\n`;
  });

  // Deviation
  const manualDev = document.getElementById("manualDeviation").value.trim();
  if (manualDev) manualDev.split("\n").forEach(d=>deviations.push(d));

  text += `\n---\n\n‚ö†Ô∏è Deviation :\n`;
  deviations.forEach(d=> text += `‚ö†Ô∏è ${d}\n`);

  return text;
}

document.getElementById("preview").onclick = ()=>{
  document.getElementById("previewBox").textContent = generateFormat();
};
document.getElementById("copy").onclick = ()=>{
  navigator.clipboard.writeText(generateFormat());
  alert("Teks disalin!");
};
document.getElementById("send").onclick = ()=>{
  const msg = encodeURIComponent(generateFormat());
  window.open(`https://wa.me/?text=${msg}`);
};
</script>

</body>
</html>
