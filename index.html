<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QA Inspection Form</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: linear-gradient(180deg, #eef3f7, #d3e3f1);
      padding: 20px;
    }
    h2 {
      text-align: center;
      color: #1b3d6d;
      text-shadow: 1px 1px 3px #aaa;
    }
    .form-card {
      background: #fff;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.15);
      margin: auto;
      max-width: 650px;
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
      color: #333;
    }
    input, textarea, select {
      width: 100%;
      margin-top: 5px;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    .check-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 4px 0;
      font-weight: normal;
    }
    .check-choice {
      display: flex;
      gap: 10px;
    }
    .check-choice input {
      width: 20px;
      height: 20px;
      cursor: pointer;
    }
    .btn {
      display: inline-block;
      margin-top: 15px;
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      color: #fff;
      font-weight: bold;
      box-shadow: 0 3px 6px rgba(0,0,0,0.15);
    }
    .btn-wa { background: #25D366; }
    .btn-copy { background: #0078FF; }
    .btn-preview { background: #FF9800; }
    .button-group {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 10px;
    }
    #previewBox {
      white-space: pre-wrap;
      background: #f9fbfd;
      border-radius: 10px;
      padding: 15px;
      margin-top: 20px;
      font-size: 14px;
      border: 1px solid #ccc;
      display: none;
    }
  </style>
</head>
<body>

  <h2>🧰 QA Inspection Form</h2>
  <div class="form-card">
    <label>Pilih Jenis Inspeksi:</label>
    <select id="qaType">
      <option value="QA-1 Pre Inspection">QA-1 Pre Inspection</option>
      <option value="QA-7 Final Inspection">QA-7 Final Inspection</option>
    </select>

    <label>Tanggal</label>
    <input id="tgl" type="date">

    <label>Mekanik</label>
    <input id="mekanik" placeholder="Contoh: Mario, Jovan">

    <label>CN</label>
    <input id="cn">

    <label>HM</label>
    <input id="hm">

    <label>🩸 Oil Level</label>
    <div id="oilLevel"></div>

    <label>⚙ Engine Area</label>
    <div id="engineArea"></div>

    <label>🚗 Cabin Area</label>
    <div id="cabinArea"></div>

    <label>🚗 Frame Area</label>
    <div id="frameArea"></div>

    <label>💧 Pressure Suspension (Panel)</label>
    <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:5px;">
      <input id="fl" placeholder="FL (MPa)">
      <input id="fr" placeholder="FR (MPa)">
      <input id="rl" placeholder="RL (MPa)">
      <input id="rr" placeholder="RR (MPa)">
    </div>

    <label>🛞 Tyre Condition</label>
    <select id="tyre">
      <option value="Good">✅ Good</option>
      <option value="Bad">❌ Bad</option>
    </select>
    <textarea id="tyreDetail" placeholder="Isi jika kondisi Bad..."></textarea>

    <label>📝 Validasi & Kelengkapan Checklist Service</label>
    <div id="validasi"></div>

    <label>⚠️ Deviation</label>
    <textarea id="deviation" placeholder="Ketik setiap temuan lalu tekan Enter..."></textarea>

    <div class="button-group">
      <button class="btn btn-wa" onclick="sendToWA()">📲 Kirim ke WA</button>
      <button class="btn btn-preview" onclick="previewText()">🧾 Preview</button>
      <button class="btn btn-copy" onclick="copyText()">📋 Salin</button>
    </div>

    <div id="previewBox"></div>
  </div>

<script>
const oilItems = ["Engine oil level", "Transmission oil level", "Hydraulic oil level"];
const engineItems = ["Belt tension", "Engine oil leakage", "Common Rail Connector", "Injector Tube"];
const cabinItems = ["FM Radio", "Fatigue Warning", "Power Window"];
const frameItems = ["Operator seat", "Hand Rail"];
const validasiItems = [
  "Job Card & Cover Checklist",
  "Form Observasi Redo PS",
  "Form QA 1 & QA 7",
  "Form PPM",
  "Form Checklist A",
  "Form Checklist B",
  "Form Checklist C",
  "Form Backlog",
  "Form FUI",
  "Form Repair Order",
  "Form Combine Maintenance",
  "Form Service Activity Report"
];

function createCheckSection(id, items) {
  const container = document.getElementById(id);
  items.forEach((item, i) => {
    const div = document.createElement("div");
    div.className = "check-item";
    div.innerHTML = `
      <span>${item}</span>
      <div class="check-choice">
        <label>✅ <input type="radio" name="${id}_${i}" value="✅"></label>
        <label>❌ <input type="radio" name="${id}_${i}" value="❌"></label>
      </div>`;
    container.appendChild(div);
  });
}

["oilLevel","engineArea","cabinArea","frameArea","validasi"].forEach((sec, i) => {
  const list = [oilItems, engineItems, cabinItems, frameItems, validasiItems][i];
  createCheckSection(sec, list);
});

function getCheckResults(id, items) {
  return items.map((item, i) => {
    const val = document.querySelector(`input[name='${id}_${i}']:checked`);
    return `${item} : ${val ? val.value : "❌"}`;
  }).join("\n");
}

function formatDeviation(text) {
  const lines = text.split('\n').filter(l => l.trim() !== '');
  if (lines.length === 0) return '';
  return '*Deviation :*\n' + lines.map(l => `⚠️ ${l.trim()}`).join('\n');
}

function generateText() {
  const qaType = document.getElementById("qaType").value;
  const tgl = document.getElementById("tgl").value;
  const mekanik = document.getElementById("mekanik").value;
  const cn = document.getElementById("cn").value;
  const hm = document.getElementById("hm").value;
  const tyre = document.getElementById("tyre").value;
  const tyreDetail = document.getElementById("tyreDetail").value;
  const deviation = formatDeviation(document.getElementById("deviation").value);

  return `*${qaType}*

📅 Tgl : ${tgl}
👷 Mekanik : ${mekanik}

🚗 CN : ${cn}
⌛ HM : ${hm}

🩸 *Oil Level* 🩸
${getCheckResults("oilLevel", oilItems)}

⚙ *Engine Area* ⚙
${getCheckResults("engineArea", engineItems)}

🚗 *Cabin Area* 🚗
${getCheckResults("cabinArea", cabinItems)}

🚗 *Frame Area* 🚗
${getCheckResults("frameArea", frameItems)}

💧 *Pressure Suspension (Panel)* 💧
FL : ${document.getElementById("fl").value} MPa | FR : ${document.getElementById("fr").value} MPa | RL : ${document.getElementById("rl").value} MPa | RR : ${document.getElementById("rr").value} MPa

🛞 *Tyre Condition :*
Tyre : ${tyre}
${tyreDetail ? "➡️ " + tyreDetail : ""}

📝 *Validasi & Kelengkapan Checklist Service :*
${getCheckResults("validasi", validasiItems)}

${deviation}`;
}

function sendToWA() {
  const text = encodeURIComponent(generateText());
  window.open(`https://wa.me/?text=${text}`, "_blank");
}

function copyText() {
  navigator.clipboard.writeText(generateText());
  alert("✅ Teks berhasil disalin ke clipboard!");
}

function previewText() {
  const preview = document.getElementById("previewBox");
  preview.innerText = generateText();
  preview.style.display = "block";
}
</script>

</body>
</html>
