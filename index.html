<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Form QA Inspection</title>
<style>
  body {
    font-family: "Segoe UI", sans-serif;
    background: linear-gradient(180deg, #e9f7ef, #fdfaf6);
    margin: 0;
    padding: 15px;
  }
  .container {
    max-width: 430px;
    margin: auto;
    background: white;
    border-radius: 15px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    padding: 15px;
  }
  header {
    text-align: center;
    background: linear-gradient(90deg, #e6d19c, #a8d5a2);
    color: #333;
    padding: 10px;
    font-weight: bold;
    border-radius: 10px;
    margin-bottom: 10px;
  }
  label { font-size: 14px; font-weight: 500; }
  input[type="text"], select, textarea {
    width: 100%;
    border: 1px solid #ccc;
    border-radius: 8px;
    padding: 6px;
    margin-top: 3px;
    font-size: 14px;
  }
  .section {
    background: #f9f9f9;
    border-radius: 12px;
    padding: 10px;
    margin-top: 10px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  }
  .item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: 6px;
  }
  .buttons {
    display: flex;
    gap: 4px;
  }
  button.toggle {
    border: none;
    border-radius: 6px;
    padding: 3px 6px;
    font-size: 13px;
    cursor: pointer;
    transition: 0.2s;
  }
  .good.active { background: #b5e7a0; }
  .bad.active { background: #f5a3a3; }
  .check.active { background: #b5e7a0; }
  .cross.active { background: #f5a3a3; }
  textarea.temuan {
    width: 100%;
    margin-top: 4px;
    display: none;
  }
  .footer-btns {
    display: flex;
    justify-content: space-around;
    margin-top: 12px;
  }
  .footer-btns button {
    border: none;
    border-radius: 10px;
    padding: 8px 10px;
    background: linear-gradient(90deg,#d6c37a,#9fd59c);
    color: #333;
    font-weight: bold;
    cursor: pointer;
  }
  #preview {
    white-space: pre-wrap;
    font-size: 13px;
    background: #fff;
    border-radius: 10px;
    padding: 10px;
    margin-top: 10px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  }
</style>
</head>
<body>

<div class="container">
  <header>🛠️ QA Inspection Form</header>

  <label>📋 Jenis Checklist</label>
  <select id="checklistType" onchange="updateValidationTitle()">
    <option value="QA1">QA1</option>
    <option value="QA7">QA7</option>
  </select>

  <label>📅 Tanggal</label>
  <input type="text" id="tanggal" placeholder="07-Oct-2025">
  <label>👷 Mekanik</label>
  <input type="text" id="mekanik">
  <label>🚗 CN Unit</label>
  <input type="text" id="cn">
  <label>⌛ HM</label>
  <input type="text" id="hm">

  <!-- Oil Level -->
  <div class="section" id="oil">
    <b>🩸 Oil Level</b>
    <div id="oilItems"></div>
  </div>

  <!-- Engine Area -->
  <div class="section" id="engine">
    <b>⚙️ Engine Area</b>
    <div id="engineItems"></div>
  </div>

  <!-- Cabin -->
  <div class="section" id="cabin">
    <b>🚗 Cabin Area</b>
    <div id="cabinItems"></div>
  </div>

  <!-- Frame -->
  <div class="section" id="frame">
    <b>🛞 Frame Area</b>
    <div id="frameItems"></div>
  </div>

  <!-- Tyre -->
  <div class="section" id="tyre">
    <b>🛠️ Tyre Condition</b>
    <div id="tyreItems"></div>
  </div>

  <!-- Pressure Suspension -->
  <div class="section">
    <b>💧 Pressure Suspension (Panel)</b>
    <input type="text" id="FL" placeholder="FL">
    <input type="text" id="FR" placeholder="FR">
    <input type="text" id="RL" placeholder="RL">
    <input type="text" id="RR" placeholder="RR">
  </div>

  <!-- Validation -->
  <div class="section">
    <b id="validationTitle">📝 Validasi & Kelengkapan Checklist Service</b>
    <div id="validationItems"></div>
  </div>

  <!-- Deviation -->
  <div class="section">
    <b>⚠️ Deviation :</b>
    <div id="deviationList"></div>
  </div>

  <div class="footer-btns">
    <button onclick="preview()">🧾 Preview</button>
    <button onclick="copyWA()">📋 Copy</button>
    <button onclick="sendWA()">📤 Send WA</button>
  </div>

  <div id="preview"></div>
</div>

<script>
const oilItems = ["Engine oil level", "Transmission oil level", "Hydraulic oil level"];
const engineItems = ["Belt tension", "Engine oil leakage", "Common Rail Connector", "Injector Tube"];
const cabinItems = ["FM Radio", "Fatigue Warning", "Power Window"];
const frameItems = ["Operator seat", "Hand Rail"];
const tyreItems = ["Tyre"];
const validationItems = [
  "Job Card & Cover Checklist","Form Observasi Redo PS","Form QA 1 & QA 7",
  "Form PPM","Form Check List A","Form Check List B","Form Check List C",
  "Form Backlog","Form FUI","Form Repair Order","Form Combine Maintenance",
  "Form Service Activity Report"
];
function createItem(containerId, list, type) {
  const container = document.getElementById(containerId);
  list.forEach(name=>{
    const div=document.createElement("div");
    div.className="item";
    div.innerHTML=`
      <span>${name}</span>
      <div class="buttons">
        <button class="toggle good" onclick="toggleButton(this,'good')">GOOD</button>
        <button class="toggle bad" onclick="toggleButton(this,'bad')">BAD</button>
      </div>
    `;
    const temuan=document.createElement("textarea");
    temuan.className="temuan";
    temuan.placeholder="Tulis temuan jika BAD...";
    container.appendChild(div);
    container.appendChild(temuan);
  });
}
function createValidationItems(){
  const v=document.getElementById("validationItems");
  v.innerHTML="";
  validationItems.forEach(name=>{
    const div=document.createElement("div");
    div.className="item";
    div.innerHTML=`
      <span>${name}</span>
      <div class="buttons">
        <button class="toggle check" onclick="toggleButton(this,'check')">✅</button>
        <button class="toggle cross" onclick="toggleButton(this,'cross')">❌</button>
      </div>`;
    v.appendChild(div);
  });
}
function toggleButton(btn,type){
  const group=btn.parentElement.querySelectorAll(".toggle");
  group.forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
  const temuan=btn.parentElement.parentElement.nextElementSibling;
  if(type==="bad" && temuan){temuan.style.display="block";}
  else if(temuan){temuan.style.display="none";}
}
function collectDeviation(){
  let devs=[];
  document.querySelectorAll(".temuan").forEach(t=>{
    if(t.value.trim()!==""){devs.push("⚠️ "+t.value.trim());}
  });
  return devs.join("\n");
}
function updateValidationTitle(){
  const type=document.getElementById("checklistType").value;
  document.getElementById("validationTitle").textContent=
    type==="QA7"?"📝 Kelengkapan Pengisian Checklist Service":"📝 Validasi & Kelengkapan Checklist Service";
}
function preview(){
  const tgl=document.getElementById("tanggal").value;
  const m=document.getElementById("mekanik").value;
  const cn=document.getElementById("cn").value;
  const hm=document.getElementById("hm").value;
  const dev=collectDeviation();
  const format=`📅 Tgl : ${tgl}
👷 Mekanik : ${m}
🚗 CN : ${cn}
⌛ HM : ${hm}

---

🩸 Oil Level 🩸
${oilItems.map(i=>formatItem(i,"oilItems")).join("")}

---

⚙️ Engine Area ⚙️
${engineItems.map(i=>formatItem(i,"engineItems")).join("")}

---

🚗 Cabin Area 🚗
${cabinItems.map(i=>formatItem(i,"cabinItems")).join("")}

---

🛞 Frame Area 🛞
${frameItems.map(i=>formatItem(i,"frameItems")).join("")}

---

🛠️ Tyre Condition 🛠️
${tyreItems.map(i=>formatItem(i,"tyreItems")).join("")}

---

💧 Pressure Suspension (Panel) 💧
FL : ${FL.value} | FR : ${FR.value} | RL : ${RL.value} | RR : ${RR.value}

---

${document.getElementById("validationTitle").textContent}
${validationItems.map(i=>formatValidation(i)).join("")}

---

⚠️ Deviation :
${dev}`;
  document.getElementById("preview").textContent=format;
}
function formatItem(name,section){
  const sectionDivs=document.querySelectorAll(`#${section.replace("Items","")} .item span`);
  for(const s of sectionDivs){
    if(s.textContent===name){
      const btns=s.parentElement.querySelectorAll(".toggle");
      let res=": ";
      btns.forEach(b=>{
        if(b.classList.contains("active")){
          res+=b.textContent;
        }
      });
      if(!res.includes("GOOD") && !res.includes("BAD")) res+="✅ GOOD";
      return `${name} ${res}\n`;
    }
  }
  return `${name} : ✅ GOOD\n`;
}
function formatValidation(name){
  const items=document.querySelectorAll("#validationItems .item span");
  for(const i of items){
    if(i.textContent===name){
      const btns=i.parentElement.querySelectorAll(".toggle");
      let res=": ";
      btns.forEach(b=>{
        if(b.classList.contains("active")){
          res+=b.textContent;
        }
      });
      if(!res.includes("✅") && !res.includes("❌")) res+="✅";
      return `${name} ${res}\n`;
    }
  }
  return `${name} ✅\n`;
}
function copyWA(){
  preview();
  const text=document.getElementById("preview").textContent;
  navigator.clipboard.writeText(text);
  alert("✅ Teks berhasil disalin!");
}
function sendWA(){
  preview();
  const text=encodeURIComponent(document.getElementById("preview").textContent);
  window.open(`https://wa.me/?text=${text}`);
}

// init
createItem("oilItems",oilItems);
createItem("engineItems",engineItems);
createItem("cabinItems",cabinItems);
createItem("frameItems",frameItems);
createItem("tyreItems",tyreItems);
createValidationItems();
</script>
</body>
</html>
